using System;
using System.ComponentModel.Composition;
using System.ComponentModel.Composition.Hosting;
using System.Linq;
using System.Reflection;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using ProjectEuler.Lib;

namespace ProjectEuler.Test {
    [TestClass]
    public class Problem8Test {
        private Problem8 _problem;

        [TestInitialize]
        public void Compose() {
            var catalog = new AssemblyCatalog(Assembly.GetAssembly(typeof(Problem8)));
            var container = new CompositionContainer(catalog);
            _problem = container.GetExports<Problem>().Select(x => x.Value as Problem8).Single(x => x != null);
        }

        [TestMethod]
        public void Problem8Example() {
            // Act
            var result = _problem.LargestProductInRangeOf(4);

            // Assert
            Assert.AreEqual(5832UL, result);
        }

        [TestMethod]
        public void Problem8Answer() {
            // Act
            var result = _problem.Answer;

            // Assert
            Assert.AreEqual("23514624000", result);
        }
    }
}
